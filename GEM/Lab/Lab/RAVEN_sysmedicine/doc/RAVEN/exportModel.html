<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of exportModel</title>
  <meta name="keywords" content="exportModel">
  <meta name="description" content="exportModel">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">RAVEN</a> &gt; exportModel.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for RAVEN&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>exportModel
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>exportModel</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function exportModel(model,fileName,toCOBRA,supressWarnings) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> exportModel
   Exports a constraint-based model to a SBML file

   model           a model structure
   fileName        the filename  to export the model to
   toCOBRA         true if the model should be exported to COBRA format. The
                   normal format is that which was defined in the Yeast
                   consensus model (opt, default false)
   supressWarnings true if warnings should be supressed (opt, default
                   false)

   Usage: exportModel(model,fileName,toCOBRA,supressWarnings)

   Rasmus Agren, 2013-08-03</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="checkModelStruct.html" class="code" title="function checkModelStruct(model,throwErrors,trimWarnings)">checkModelStruct</a>	checkModelStruct</li><li><a href="cleanBadCharsInModel.html" class="code" title="function model=cleanBadCharsInModel(model)">cleanBadCharsInModel</a>	cleanBadCharsInModel</li><li><a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>	dispEM</li></ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="SBMLFromExcel.html" class="code" title="function SBMLFromExcel(fileName, outputFileName,toCOBRA,printWarnings)">SBMLFromExcel</a>	SBMLFromExcel</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function miriamString=getMiriam(miriamStruct)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function exportModel(model,fileName,toCOBRA,supressWarnings)</a>
0002 <span class="comment">% exportModel</span>
0003 <span class="comment">%   Exports a constraint-based model to a SBML file</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   model           a model structure</span>
0006 <span class="comment">%   fileName        the filename  to export the model to</span>
0007 <span class="comment">%   toCOBRA         true if the model should be exported to COBRA format. The</span>
0008 <span class="comment">%                   normal format is that which was defined in the Yeast</span>
0009 <span class="comment">%                   consensus model (opt, default false)</span>
0010 <span class="comment">%   supressWarnings true if warnings should be supressed (opt, default</span>
0011 <span class="comment">%                   false)</span>
0012 <span class="comment">%</span>
0013 <span class="comment">%   Usage: exportModel(model,fileName,toCOBRA,supressWarnings)</span>
0014 <span class="comment">%</span>
0015 <span class="comment">%   Rasmus Agren, 2013-08-03</span>
0016 <span class="comment">%</span>
0017 
0018 <span class="keyword">if</span> nargin&lt;3
0019     toCOBRA=false;
0020 <span class="keyword">end</span>
0021 <span class="keyword">if</span> nargin&lt;4
0022     supressWarnings=false;
0023 <span class="keyword">end</span>
0024 
0025 <span class="comment">%Check if the &quot;unconstrained&quot; field is still present. This shows if</span>
0026 <span class="comment">%exchange metabolites have been removed</span>
0027 <span class="keyword">if</span> ~isfield(model,<span class="string">'unconstrained'</span>)
0028     <span class="keyword">if</span> supressWarnings==false
0029         <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(<span class="string">'There is no unconstrained field in the model structure. This means that no metabolites are considered exchange metabolites'</span>,false);
0030     <span class="keyword">end</span>
0031     model.unconstrained=zeros(numel(model.mets),1);
0032 <span class="keyword">end</span>
0033 
0034 <span class="comment">%Check the model structure</span>
0035 <span class="keyword">if</span> supressWarnings==false
0036    <a href="checkModelStruct.html" class="code" title="function checkModelStruct(model,throwErrors,trimWarnings)">checkModelStruct</a>(model,false); 
0037 <span class="keyword">end</span>
0038 
0039 <span class="comment">%For converting illegal characters to their entity reference</span>
0040 model=<a href="cleanBadCharsInModel.html" class="code" title="function model=cleanBadCharsInModel(model)">cleanBadCharsInModel</a>(model);
0041 
0042 <span class="comment">%Check if genes have associated compartments</span>
0043 <span class="keyword">if</span> ~isfield(model,<span class="string">'geneComps'</span>) &amp;&amp; isfield(model,<span class="string">'genes'</span>)
0044     <span class="keyword">if</span> supressWarnings==false
0045         <a href="dispEM.html" class="code" title="function dispEM(string,throwErrors,toList,trimWarnings)">dispEM</a>(<span class="string">'There are no compartments specified for genes. All genes will be assigned to the first compartment. This is because the SBML structure requires all elements to be assigned to a compartment'</span>,false);
0046     <span class="keyword">end</span>
0047     model.geneComps=ones(numel(model.genes),1);
0048 <span class="keyword">end</span>
0049 
0050 <span class="comment">%Generate temporary filename</span>
0051 tempF=tempname();
0052 
0053 <span class="comment">%Open a stream</span>
0054 fid = fopen(tempF,<span class="string">'w'</span>);
0055 
0056 <span class="comment">%Writes the intro</span>
0057 <span class="keyword">if</span> toCOBRA==false
0058     intro=[<span class="string">'&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;'</span><span class="keyword">...</span>
0059     <span class="string">'&lt;sbml xmlns=&quot;http://www.sbml.org/sbml/level2/version3&quot; level=&quot;2&quot; version=&quot;3&quot;&gt;'</span><span class="keyword">...</span>
0060     <span class="string">'&lt;model metaid=&quot;metaid_'</span> model.id <span class="string">'&quot; id=&quot;'</span> model.id <span class="string">'&quot; name=&quot;'</span> model.description <span class="string">'&quot;&gt;'</span>];
0061     <span class="keyword">if</span> isfield(model,<span class="string">'annotation'</span>)
0062         <span class="keyword">if</span> isfield(model.annotation,<span class="string">'note'</span>)
0063             intro=[intro <span class="string">'&lt;notes&gt;&lt;body xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;'</span> model.annotation.note <span class="string">'&lt;/body&gt;&lt;/notes&gt;\n'</span>];
0064         <span class="keyword">end</span>
0065     <span class="keyword">else</span>
0066         intro=[intro <span class="string">'&lt;notes&gt;&lt;body xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;This file was generated using the exportModel function in RAVEN Toolbox&lt;/body&gt;&lt;/notes&gt;\n'</span>];
0067     <span class="keyword">end</span>
0068     intro=[intro <span class="string">'&lt;annotation&gt;'</span><span class="keyword">...</span>
0069     <span class="string">'&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; xmlns:dcterms=&quot;http://purl.org/dc/terms/&quot; xmlns:vCard=&quot;http://www.w3.org/2001/vcard-rdf/3.0#&quot; xmlns:bqbiol=&quot;http://biomodels.net/biology-qualifiers/&quot; xmlns:bqmodel=&quot;http://biomodels.net/model-qualifiers/&quot;&gt;'</span><span class="keyword">...</span>
0070     <span class="string">'&lt;rdf:Description rdf:about=&quot;#metaid_'</span> model.id <span class="string">'&quot;&gt;'</span>];
0071     <span class="keyword">if</span> isfield(model,<span class="string">'annotation'</span>)
0072         nameString=<span class="string">''</span>;
0073         <span class="keyword">if</span> isfield(model.annotation,<span class="string">'givenName'</span>)
0074             <span class="keyword">if</span> ~isempty(model.annotation.givenName)
0075                 nameString=[<span class="string">'&lt;vCard:Given&gt;'</span> model.annotation.givenName <span class="string">'&lt;/vCard:Given&gt;'</span>];
0076             <span class="keyword">end</span>
0077         <span class="keyword">end</span>
0078         <span class="keyword">if</span> isfield(model.annotation,<span class="string">'familyName'</span>)
0079             <span class="keyword">if</span> ~isempty(model.annotation.familyName)
0080                 nameString=[nameString <span class="string">'&lt;vCard:Family&gt;'</span> model.annotation.familyName <span class="string">'&lt;/vCard:Family&gt;'</span>];
0081             <span class="keyword">end</span>
0082         <span class="keyword">end</span>
0083         email=<span class="string">''</span>;
0084         <span class="keyword">if</span> isfield(model.annotation,<span class="string">'email'</span>)
0085             <span class="keyword">if</span> ~isempty(model.annotation.email)
0086                 email=[<span class="string">'&lt;vCard:EMAIL&gt;'</span> model.annotation.email <span class="string">'&lt;/vCard:EMAIL&gt;'</span>];
0087             <span class="keyword">end</span>
0088         <span class="keyword">end</span>
0089         org=<span class="string">''</span>;
0090         <span class="keyword">if</span> isfield(model.annotation,<span class="string">'organization'</span>)
0091             <span class="keyword">if</span> ~isempty(model.annotation.organization)
0092                 org=[<span class="string">'&lt;vCard:ORG&gt;&lt;vCard:Orgname&gt;'</span> model.annotation.organization <span class="string">'&lt;/vCard:Orgname&gt;&lt;/vCard:ORG&gt;'</span>];
0093             <span class="keyword">end</span>
0094         <span class="keyword">end</span>
0095         <span class="keyword">if</span> ~isempty(nameString) || ~isempty(email) || ~isempty(org)
0096             intro=[intro <span class="string">'&lt;dc:creator rdf:parseType=&quot;Resource&quot;&gt;&lt;rdf:Bag&gt;&lt;rdf:li rdf:parseType=&quot;Resource&quot;&gt;'</span>];
0097             <span class="keyword">if</span> ~isempty(nameString)
0098                 intro=[intro <span class="string">'&lt;vCard:N rdf:parseType=&quot;Resource&quot;&gt;'</span> nameString <span class="string">'&lt;/vCard:N&gt;'</span>];
0099             <span class="keyword">end</span>
0100             intro=[intro email org <span class="string">'&lt;/rdf:li&gt;&lt;/rdf:Bag&gt;&lt;/dc:creator&gt;'</span>];
0101         <span class="keyword">end</span>
0102     <span class="keyword">end</span>
0103     intro=[intro <span class="string">'&lt;dcterms:created rdf:parseType=&quot;Resource&quot;&gt;'</span><span class="keyword">...</span>
0104     <span class="string">'&lt;dcterms:W3CDTF&gt;'</span> datestr(now,<span class="string">'yyyy-mm-ddTHH:MM:SSZ'</span>) <span class="string">'&lt;/dcterms:W3CDTF&gt;'</span><span class="keyword">...</span><span class="comment"> </span>
0105     <span class="string">'&lt;/dcterms:created&gt;'</span><span class="keyword">...</span>
0106     <span class="string">'&lt;dcterms:modified rdf:parseType=&quot;Resource&quot;&gt;'</span><span class="keyword">...</span>
0107     <span class="string">'&lt;dcterms:W3CDTF&gt;'</span> datestr(now,<span class="string">'yyyy-mm-ddTHH:MM:SSZ'</span>) <span class="string">'&lt;/dcterms:W3CDTF&gt;'</span><span class="keyword">...</span><span class="comment"> </span>
0108     <span class="string">'&lt;/dcterms:modified&gt;'</span>];
0109 
0110     <span class="keyword">if</span> isfield(model,<span class="string">'annotation'</span>)
0111         <span class="keyword">if</span> isfield(model.annotation,<span class="string">'taxonomy'</span>)
0112             intro=[intro <span class="string">'&lt;bqbiol:is&gt;&lt;rdf:Bag&gt;&lt;rdf:li rdf:resource=&quot;urn:miriam:'</span> model.annotation.taxonomy <span class="string">'&quot; /&gt;&lt;/rdf:Bag&gt;&lt;/bqbiol:is&gt;'</span>];
0113         <span class="keyword">end</span>
0114     <span class="keyword">end</span>
0115     intro=[intro <span class="string">'&lt;/rdf:Description&gt;'</span><span class="keyword">...</span>
0116     <span class="string">'&lt;/rdf:RDF&gt;'</span><span class="keyword">...</span>
0117     <span class="string">'&lt;/annotation&gt;'</span>];
0118 <span class="keyword">else</span>
0119     intro=[<span class="string">'&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;sbml xmlns=&quot;http://www.sbml.org/sbml/level2&quot; level=&quot;2&quot; version=&quot;1&quot; xmlns:html=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;model id=&quot;'</span> model.id <span class="string">'&quot; name=&quot;'</span> model.description <span class="string">'&quot;&gt;'</span>];
0120     <span class="keyword">if</span> isfield(model,<span class="string">'annotation'</span>)
0121         <span class="keyword">if</span> isfield(model.annotation,<span class="string">'note'</span>)
0122             intro=[intro <span class="string">'&lt;notes&gt;&lt;body xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;'</span> model.annotation.note <span class="string">'&lt;/body&gt;&lt;/notes&gt;\n'</span>];
0123         <span class="keyword">end</span>
0124     <span class="keyword">end</span>
0125 <span class="keyword">end</span>
0126 
0127 intro=[intro <span class="string">'&lt;listOfUnitDefinitions&gt;'</span><span class="keyword">...</span>
0128 <span class="string">'&lt;unitDefinition id=&quot;mmol_per_gDW_per_hr&quot;&gt;'</span><span class="keyword">...</span>
0129 <span class="string">'&lt;listOfUnits&gt;'</span><span class="keyword">...</span>
0130 <span class="string">'&lt;unit kind=&quot;mole&quot; scale=&quot;-3&quot;/&gt;'</span><span class="keyword">...</span>
0131 <span class="string">'&lt;unit kind=&quot;second&quot; multiplier=&quot;0.00027778&quot; exponent=&quot;-1&quot;/&gt;'</span><span class="keyword">...</span>
0132 <span class="string">'&lt;/listOfUnits&gt;'</span><span class="keyword">...</span>
0133 <span class="string">'&lt;/unitDefinition&gt;'</span><span class="keyword">...</span>
0134 <span class="string">'&lt;/listOfUnitDefinitions&gt;'</span><span class="keyword">...</span>
0135 <span class="string">'&lt;listOfCompartments&gt;'</span>];
0136 
0137 <span class="comment">%Write intro</span>
0138 fprintf(fid,intro);
0139 
0140 <span class="comment">%Write compartments</span>
0141 <span class="keyword">for</span> i=1:numel(model.comps)
0142     <span class="comment">%Check if it's outside anything</span>
0143     <span class="keyword">if</span> isfield(model, <span class="string">'compOutside'</span>)
0144         <span class="keyword">if</span> ~isempty(model.compOutside{i})
0145             append=[<span class="string">' outside=&quot;C_'</span> model.compOutside{i} <span class="string">'&quot; spatialDimensions=&quot;3&quot;'</span>];
0146         <span class="keyword">else</span>
0147             append=<span class="string">' spatialDimensions=&quot;3&quot;'</span>;
0148         <span class="keyword">end</span>
0149     <span class="keyword">else</span>
0150         append=<span class="string">' spatialDimensions=&quot;3&quot;'</span>;
0151     <span class="keyword">end</span>
0152     
0153     <span class="keyword">if</span> toCOBRA==false
0154         fprintf(fid,[<span class="string">'&lt;compartment metaid=&quot;metaid_C_'</span> model.comps{i} <span class="string">'&quot; id=&quot;C_'</span> model.comps{i} <span class="string">'&quot; name=&quot;'</span> model.compNames{i} <span class="string">'&quot;'</span> append <span class="string">' size=&quot;1&quot; sboTerm=&quot;SBO:0000290&quot;&gt;'</span>]);
0155 
0156         <span class="comment">%Print associated Miriam strings</span>
0157         <span class="keyword">if</span> isfield(model,<span class="string">'compMiriams'</span>)
0158             miriamString=<a href="#_sub1" class="code" title="subfunction miriamString=getMiriam(miriamStruct)">getMiriam</a>(model.compMiriams{i});
0159         <span class="keyword">else</span>
0160             miriamString=[];
0161         <span class="keyword">end</span>
0162 
0163         <span class="keyword">if</span> ~isempty(miriamString)
0164             compinfo=[<span class="string">'&lt;annotation&gt;&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; xmlns:dcterms='</span><span class="keyword">...</span>
0165                     <span class="string">'&quot;http://purl.org/dc/terms/&quot; xmlns:vCard=&quot;http://www.w3.org/2001/vcard-rdf/3.0#&quot; xmlns:bqbiol=&quot;http://biomodels.net/biology-qualifiers/&quot; '</span><span class="keyword">...</span>
0166                     <span class="string">'xmlns:bqmodel=&quot;http://biomodels.net/model-qualifiers/&quot;&gt;&lt;rdf:Description rdf:about=&quot;#metaid_C_'</span> model.comps{i} <span class="string">'&quot;&gt;'</span><span class="keyword">...</span>
0167                     <span class="string">'&lt;bqbiol:is&gt;&lt;rdf:Bag&gt;'</span> miriamString <span class="string">'&lt;/rdf:Bag&gt;&lt;/bqbiol:is&gt;'</span><span class="keyword">...</span>
0168                     <span class="string">'&lt;/rdf:Description&gt;&lt;/rdf:RDF&gt;&lt;/annotation&gt;&lt;/compartment&gt;'</span>];
0169         <span class="keyword">else</span>
0170             compinfo=<span class="string">'&lt;/compartment&gt;\n'</span>;
0171         <span class="keyword">end</span>
0172         fprintf(fid,compinfo);
0173     <span class="keyword">else</span>
0174         fprintf(fid,[<span class="string">'&lt;compartment id=&quot;C_'</span> model.comps{i} <span class="string">'&quot; name=&quot;'</span> model.compNames{i} <span class="string">'&quot;'</span> append <span class="string">'&gt;&lt;/compartment&gt;'</span>]);
0175     <span class="keyword">end</span>
0176 <span class="keyword">end</span>
0177 
0178 intro=<span class="string">'&lt;/listOfCompartments&gt;&lt;listOfSpecies&gt;'</span>;
0179 fprintf(fid,intro);
0180 
0181 <span class="comment">%Begin writing species</span>
0182 <span class="keyword">for</span> i=1:numel(model.mets)
0183     <span class="keyword">if</span> model.unconstrained(i)
0184         unbounded=<span class="string">'true'</span>;
0185     <span class="keyword">else</span>
0186         unbounded=<span class="string">'false'</span>;
0187     <span class="keyword">end</span>
0188     
0189     <span class="keyword">if</span> toCOBRA==false
0190         toprint=[<span class="string">'&lt;species metaid=&quot;metaid_M_'</span> model.mets{i} <span class="string">'&quot; id=&quot;M_'</span> model.mets{i} <span class="string">'&quot; name=&quot;'</span> model.metNames{i} <span class="string">'&quot; compartment=&quot;C_'</span> model.comps{model.metComps(i)} <span class="string">'&quot; initialAmount=&quot;0&quot; boundaryCondition=&quot;'</span> unbounded <span class="string">'&quot; sboTerm=&quot;SBO:0000299&quot;&gt;'</span>];
0191     <span class="keyword">else</span>
0192         <span class="comment">%For COBRA format the formula is appended to the metabolite name</span>
0193         <span class="keyword">if</span> isfield(model,<span class="string">'metFormulas'</span>)
0194             <span class="keyword">if</span> ~isempty(model.metFormulas(i))
0195                 append=[<span class="string">'_'</span> model.metFormulas{i}];
0196             <span class="keyword">else</span>
0197                 append=<span class="string">'_'</span>;
0198             <span class="keyword">end</span>
0199         <span class="keyword">else</span>
0200             append=<span class="string">'_'</span>; 
0201         <span class="keyword">end</span>
0202         toprint=[<span class="string">'&lt;species id=&quot;M_'</span> model.mets{i} <span class="string">'&quot; name=&quot;'</span> model.metNames{i} append <span class="string">'&quot; compartment=&quot;C_'</span> model.comps{model.metComps(i)} <span class="string">'&quot; initialAmount=&quot;0&quot; boundaryCondition=&quot;'</span> unbounded <span class="string">'&quot;&gt;'</span>];
0203     <span class="keyword">end</span>
0204     
0205     <span class="comment">%Print some stuff if there is a formula for the compound</span>
0206     <span class="keyword">if</span> toCOBRA==false
0207         <span class="keyword">if</span> isfield(model,<span class="string">'metFormulas'</span>)
0208             <span class="comment">%Only print formula if there is no InChI. This is because the</span>
0209             <span class="comment">%metFormulas field is populated by InChIs if available</span>
0210             hasInchi=false;
0211             <span class="keyword">if</span> isfield(model,<span class="string">'inchis'</span>)
0212                 <span class="keyword">if</span> ~isempty(model.inchis{i})
0213                     hasInchi=true;
0214                 <span class="keyword">end</span>
0215             <span class="keyword">end</span>
0216 
0217             <span class="keyword">if</span> ~isempty(model.metFormulas{i}) &amp;&amp; hasInchi==false
0218                 toprint=[toprint <span class="string">'&lt;notes&gt;&lt;body xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;p&gt;FORMULA: '</span>  model.metFormulas{i} <span class="string">'&lt;/p&gt;&lt;/body&gt;&lt;/notes&gt;'</span>];
0219             <span class="keyword">end</span>
0220         <span class="keyword">end</span>    
0221         <span class="keyword">if</span> isfield(model,<span class="string">'metMiriams'</span>)
0222             miriamString=<a href="#_sub1" class="code" title="subfunction miriamString=getMiriam(miriamStruct)">getMiriam</a>(model.metMiriams{i});
0223         <span class="keyword">else</span>
0224             miriamString=<span class="string">''</span>;
0225         <span class="keyword">end</span>
0226 
0227         <span class="keyword">if</span> isfield(model,<span class="string">'inchis'</span>)
0228            <span class="keyword">if</span> ~isempty(model.inchis{i})
0229                 isInchi=true;
0230            <span class="keyword">else</span>
0231                 isInchi=false;
0232            <span class="keyword">end</span>
0233         <span class="keyword">else</span>
0234             isInchi=false;
0235         <span class="keyword">end</span>
0236 
0237         <span class="keyword">if</span> any(miriamString) || isInchi==true 
0238             toprint=[toprint <span class="string">'&lt;annotation&gt;'</span>];
0239 
0240             <span class="comment">%Print InChI if available</span>
0241             <span class="keyword">if</span> isInchi==true
0242                 toprint=[toprint <span class="string">'&lt;in:inchi xmlns:in=&quot;http://biomodels.net/inchi&quot; metaid=&quot;metaid_M_'</span> model.mets{i} <span class="string">'_inchi&quot;&gt;InChI='</span> model.inchis{i} <span class="string">'&lt;/in:inchi&gt;'</span>];
0243             <span class="keyword">end</span>
0244             <span class="comment">%Print some more annotation stuff</span>
0245             toprint=[toprint <span class="string">'&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; xmlns:dcterms=&quot;http://purl.org/dc/terms/&quot; '</span><span class="keyword">...</span>
0246                 <span class="string">'xmlns:vCard=&quot;http://www.w3.org/2001/vcard-rdf/3.0#&quot; xmlns:bqbiol=&quot;http://biomodels.net/biology-qualifiers/&quot; xmlns:bqmodel=&quot;http://biomodels.net/model-qualifiers/&quot;&gt;'</span><span class="keyword">...</span>
0247                 <span class="string">'&lt;rdf:Description rdf:about=&quot;#metaid_M_'</span> model.mets{i} <span class="string">'&quot;&gt;'</span><span class="keyword">...</span>
0248                 <span class="string">'&lt;bqbiol:is&gt;'</span><span class="keyword">...</span>
0249                 <span class="string">'&lt;rdf:Bag&gt;'</span>];
0250             <span class="keyword">if</span> isInchi==true
0251                 toprint=[toprint <span class="string">'&lt;rdf:li rdf:resource=&quot;#metaid_M_'</span> model.mets{i} <span class="string">'_inchi&quot; /&gt;'</span>];
0252             <span class="keyword">end</span>
0253 
0254             <span class="comment">%Print Miriam and finish up</span>
0255             toprint=[toprint miriamString <span class="string">'&lt;/rdf:Bag&gt;&lt;/bqbiol:is&gt;&lt;/rdf:Description&gt;&lt;/rdf:RDF&gt;&lt;/annotation&gt;'</span>];
0256         <span class="keyword">end</span>
0257     <span class="keyword">end</span>
0258     toprint=[toprint <span class="string">'&lt;/species&gt;\n'</span>];
0259     fprintf(fid,toprint);
0260 <span class="keyword">end</span>
0261 
0262 <span class="comment">%Write genes and complexes</span>
0263 <span class="keyword">if</span> toCOBRA==false
0264     <span class="comment">%Write genes</span>
0265     <span class="keyword">if</span> isfield(model,<span class="string">'genes'</span>)
0266         <span class="keyword">for</span> i=1:numel(model.genes)
0267            toprint=[<span class="string">'&lt;species metaid=&quot;metaid_E_'</span> int2str(i) <span class="string">'&quot; id=&quot;E_'</span> int2str(i) <span class="string">'&quot; name=&quot;'</span> model.genes{i} <span class="string">'&quot; compartment=&quot;C_'</span> model.comps{model.geneComps(i)} <span class="string">'&quot; initialAmount=&quot;0&quot; sboTerm=&quot;SBO:0000014&quot;&gt;'</span>];
0268 
0269            <span class="comment">%Print gene name if present</span>
0270            <span class="keyword">if</span> isfield(model,<span class="string">'geneShortNames'</span>)
0271                <span class="keyword">if</span> ~isempty(model.geneShortNames{i})
0272                     toprint=[toprint <span class="string">'&lt;notes&gt;&lt;body xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;&lt;p&gt;SHORT NAME: '</span>  model.geneShortNames{i} <span class="string">'&lt;/p&gt;&lt;/body&gt;&lt;/notes&gt;'</span>];
0273                <span class="keyword">end</span>
0274            <span class="keyword">end</span>
0275 
0276            <span class="keyword">if</span> isfield(model,<span class="string">'geneMiriams'</span>)
0277                 miriamString=<a href="#_sub1" class="code" title="subfunction miriamString=getMiriam(miriamStruct)">getMiriam</a>(model.geneMiriams{i});
0278            <span class="keyword">else</span>
0279                 miriamString=[]; 
0280            <span class="keyword">end</span>
0281 
0282            <span class="keyword">if</span> ~isempty(miriamString)
0283                toprint=[toprint <span class="string">'&lt;annotation&gt;&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; '</span><span class="keyword">...</span>
0284                     <span class="string">'xmlns:dcterms=&quot;http://purl.org/dc/terms/&quot; xmlns:vCard=&quot;http://www.w3.org/2001/vcard-rdf/3.0#&quot; xmlns:bqbiol=&quot;http://biomodels.net/biology-qualifiers/&quot; '</span><span class="keyword">...</span>
0285                     <span class="string">'xmlns:bqmodel=&quot;http://biomodels.net/model-qualifiers/&quot;&gt;&lt;rdf:Description rdf:about=&quot;#metaid_E_'</span> int2str(i) <span class="string">'&quot;&gt;&lt;bqbiol:is&gt;&lt;rdf:Bag&gt;'</span><span class="keyword">...</span>
0286                     miriamString <span class="string">'&lt;/rdf:Bag&gt;&lt;/bqbiol:is&gt;&lt;/rdf:Description&gt;&lt;/rdf:RDF&gt;&lt;/annotation&gt;'</span>];
0287            <span class="keyword">end</span>
0288 
0289            toprint=[toprint <span class="string">'&lt;/species&gt;\n'</span>];
0290            fprintf(fid,toprint);
0291         <span class="keyword">end</span>
0292 
0293         <span class="comment">%Also add the complexes as species. This is done by splitting grRules</span>
0294         <span class="comment">%on &quot;or&quot; and addding the ones which contain several genes</span>
0295         geneComplexes={};
0296         <span class="keyword">if</span> isfield(model,<span class="string">'grRules'</span>)
0297             <span class="comment">%Only grRules which contain &quot; and &quot; can be complexes</span>
0298             uniqueRules=unique(model.grRules);
0299             I=cellfun(@any,strfind(uniqueRules,<span class="string">' and '</span>));
0300             uniqueRules(~I)=[];
0301             uniqueRules=strrep(uniqueRules,<span class="string">'('</span>,<span class="string">''</span>);
0302             uniqueRules=strrep(uniqueRules,<span class="string">')'</span>,<span class="string">''</span>);
0303             uniqueRules=strrep(uniqueRules,<span class="string">' and '</span>,<span class="string">':'</span>);
0304             <span class="keyword">for</span> i=1:numel(uniqueRules)
0305                 genes=regexp(uniqueRules(i),<span class="string">' or '</span>,<span class="string">'split'</span>);
0306                 genes=genes{1}(:);
0307                 <span class="comment">%Check which ones are complexes</span>
0308                 I=cellfun(@any,strfind(genes,<span class="string">':'</span>));
0309                 geneComplexes=[geneComplexes;genes(I)];
0310             <span class="keyword">end</span>
0311         <span class="keyword">end</span>
0312         geneComplexes=unique(geneComplexes);
0313 
0314         <span class="comment">%Then add them as species. There is a possiblity that a complex A&amp;B is</span>
0315         <span class="comment">%added as separate from B&amp;A. This isn't really an issue so I don't deal</span>
0316         <span class="comment">%with it</span>
0317         <span class="keyword">for</span> i=1:numel(geneComplexes)
0318             <span class="comment">%The SBO term for the complex is set to the same as for genes. Might not be</span>
0319             <span class="comment">%correct. All complexes are added to the first compartment</span>
0320             fprintf(fid,[<span class="string">'&lt;species metaid=&quot;metaid_Cx_'</span> int2str(i) <span class="string">'&quot; id=&quot;Cx_'</span> int2str(i) <span class="string">'&quot; name=&quot;'</span> geneComplexes{i} <span class="string">'&quot; compartment=&quot;C_'</span> model.comps{1} <span class="string">'&quot; initialAmount=&quot;0&quot; sboTerm=&quot;SBO:0000014&quot;&gt;&lt;/species&gt;\n'</span>]);
0321         <span class="keyword">end</span>
0322     <span class="keyword">end</span>
0323 <span class="keyword">end</span>
0324 
0325 <span class="comment">%Finish metbolites</span>
0326 fprintf(fid,<span class="string">'&lt;/listOfSpecies&gt;'</span>);
0327 
0328 <span class="comment">%Add reactions</span>
0329 fprintf(fid,<span class="string">'&lt;listOfReactions&gt;'</span>);
0330 
0331 <span class="keyword">if</span> toCOBRA==false
0332     <span class="keyword">if</span> isfield(model,<span class="string">'grRules'</span>)
0333         <span class="comment">%This is for dealing with complexes</span>
0334         model.grRules=strrep(model.grRules,<span class="string">'('</span>,<span class="string">''</span>);
0335         model.grRules=strrep(model.grRules,<span class="string">')'</span>,<span class="string">''</span>);
0336         model.grRules=strrep(model.grRules,<span class="string">' and '</span>,<span class="string">':'</span>);
0337     <span class="keyword">end</span>
0338 <span class="keyword">end</span>
0339 
0340 <span class="keyword">for</span> i=1:length(model.rxns)
0341     <span class="comment">%Get reversibility</span>
0342     reversible=<span class="string">'false'</span>;
0343     <span class="keyword">if</span> model.rev(i)==1
0344         reversible=<span class="string">'true'</span>;
0345     <span class="keyword">end</span>
0346     
0347     <span class="keyword">if</span> isfield(model,<span class="string">'subSystems'</span>)
0348         subsystem=model.subSystems{i};
0349     <span class="keyword">else</span>
0350         subsystem=[];
0351     <span class="keyword">end</span>
0352     <span class="keyword">if</span> isfield(model,<span class="string">'rxnComps'</span>)
0353         rxnComps=model.comps{model.rxnComps(i)};
0354     <span class="keyword">else</span>
0355         rxnComps=[];
0356     <span class="keyword">end</span>
0357     <span class="keyword">if</span> isfield(model,<span class="string">'eccodes'</span>)
0358         eccode=model.eccodes{i};
0359     <span class="keyword">else</span>
0360         eccode=[];
0361     <span class="keyword">end</span>
0362         
0363     <span class="keyword">if</span> toCOBRA==false
0364         fprintf(fid,[<span class="string">'&lt;reaction metaid=&quot;metaid_R_'</span> model.rxns{i} <span class="string">'&quot; id=&quot;R_'</span> model.rxns{i} <span class="string">'&quot; name=&quot;'</span> model.rxnNames{i} <span class="string">'&quot; reversible=&quot;'</span> reversible <span class="string">'&quot; sboTerm=&quot;SBO:0000176&quot;&gt;'</span>]);
0365 
0366         <span class="keyword">if</span> ~isempty(subsystem) || ~isempty(rxnComps)
0367             toPrint=<span class="string">''</span>;
0368             <span class="keyword">if</span> ~isempty(subsystem)
0369                toPrint=[toPrint <span class="string">'&lt;p&gt;SUBSYSTEM: '</span> subsystem <span class="string">'&lt;/p&gt;'</span>]; 
0370             <span class="keyword">end</span>
0371             <span class="comment">%Compartment isn't an allowed attribute until SBML L3 and I don't</span>
0372             <span class="comment">%feel like changing format just for that</span>
0373             <span class="keyword">if</span> ~isempty(rxnComps)
0374                toPrint=[toPrint <span class="string">'&lt;p&gt;COMPARTMENT: '</span> rxnComps <span class="string">'&lt;/p&gt;'</span>]; 
0375             <span class="keyword">end</span>
0376             fprintf(fid,[<span class="string">'&lt;notes&gt;&lt;body xmlns=&quot;http://www.w3.org/1999/xhtml&quot;&gt;'</span> toPrint <span class="string">'&lt;/body&gt;&lt;/notes&gt;'</span>]);
0377         <span class="keyword">end</span>
0378 
0379         <span class="comment">%Print annotation</span>
0380         <span class="keyword">if</span> isfield(model,<span class="string">'rxnMiriams'</span>)
0381             miriamString=<a href="#_sub1" class="code" title="subfunction miriamString=getMiriam(miriamStruct)">getMiriam</a>(model.rxnMiriams{i});
0382         <span class="keyword">else</span>
0383             miriamString=[];
0384         <span class="keyword">end</span>
0385 
0386         <span class="comment">%Check to see if there is an associated ec-code</span>
0387         <span class="keyword">if</span> any(eccode)
0388             <span class="comment">%Several ec-codes can be delimited by &quot;;&quot;</span>
0389             eccodes=regexp(eccode,<span class="string">';'</span>,<span class="string">'split'</span>);
0390             <span class="keyword">for</span> j=1:numel(eccodes)
0391                 miriamString=[miriamString  <span class="string">'&lt;rdf:li rdf:resource=&quot;urn:miriam:ec-code:'</span> eccodes{j} <span class="string">'&quot;/&gt;'</span>];
0392             <span class="keyword">end</span>
0393         <span class="keyword">end</span>
0394 
0395         <span class="keyword">if</span> ~isempty(miriamString)
0396             fprintf(fid,[<span class="string">'&lt;annotation&gt;&lt;rdf:RDF xmlns:rdf=&quot;http://www.w3.org/1999/02/22-rdf-syntax-ns#&quot; '</span><span class="keyword">...</span>
0397             <span class="string">'xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; xmlns:dcterms=&quot;http://purl.org/dc/terms/&quot; '</span><span class="keyword">...</span>
0398             <span class="string">'xmlns:vCard=&quot;http://www.w3.org/2001/vcard-rdf/3.0#&quot; xmlns:bqbiol=&quot;http://biomodels.net/biology-qualifiers/&quot; '</span><span class="keyword">...</span>
0399             <span class="string">'xmlns:bqmodel=&quot;http://biomodels.net/model-qualifiers/&quot;&gt;'</span><span class="keyword">...</span>
0400             <span class="string">'&lt;rdf:Description rdf:about=&quot;#metaid_R_'</span> model.rxns{i} <span class="string">'&quot;&gt;'</span><span class="keyword">...</span>
0401             <span class="string">'&lt;bqbiol:is&gt;'</span><span class="keyword">...</span>
0402             <span class="string">'&lt;rdf:Bag&gt;'</span><span class="keyword">...</span>
0403             miriamString<span class="keyword">...</span><span class="comment"> </span>
0404             <span class="string">'&lt;/rdf:Bag&gt;'</span><span class="keyword">...</span>
0405             <span class="string">'&lt;/bqbiol:is&gt;'</span><span class="keyword">...</span>
0406             <span class="string">'&lt;/rdf:Description&gt;'</span><span class="keyword">...</span>
0407             <span class="string">'&lt;/rdf:RDF&gt;'</span><span class="keyword">...</span>
0408             <span class="string">'&lt;/annotation&gt;'</span>]);
0409         <span class="keyword">end</span>
0410     <span class="keyword">else</span>
0411        <span class="keyword">if</span> isfield(model,<span class="string">'grRules'</span>)
0412             grRules=model.grRules{i};
0413        <span class="keyword">else</span>
0414             grRules=[];
0415        <span class="keyword">end</span>
0416        
0417        <span class="comment">%COBRA format</span>
0418        fprintf(fid,[<span class="string">'&lt;reaction id=&quot;R_'</span> model.rxns{i} <span class="string">'&quot; name=&quot;'</span> model.rxnNames{i} <span class="string">'&quot; reversible=&quot;'</span> reversible <span class="string">'&quot;&gt;'</span>]);
0419        
0420         fprintf(fid,<span class="string">'&lt;notes&gt;'</span>);
0421         <span class="keyword">if</span> any(grRules)
0422             fprintf(fid,[<span class="string">'&lt;html:p&gt;GENE_ASSOCIATION: '</span> grRules <span class="string">'&lt;/html:p&gt;'</span>]);
0423         <span class="keyword">end</span>
0424         <span class="keyword">if</span> any(subsystem)
0425             fprintf(fid,[<span class="string">'&lt;html:p&gt;SUBSYSTEM: '</span> subsystem <span class="string">'&lt;/html:p&gt;'</span>]);
0426         <span class="keyword">end</span>
0427         <span class="keyword">if</span> any(eccode)
0428             fprintf(fid,[<span class="string">'&lt;html:p&gt;PROTEIN_CLASS: '</span> eccode <span class="string">'&lt;/html:p&gt;'</span>]);
0429         <span class="keyword">end</span>
0430         fprintf(fid,<span class="string">'&lt;/notes&gt;'</span>);
0431     <span class="keyword">end</span>
0432     
0433     <span class="comment">%The reactants have negative values in the stochiometric matrix</span>
0434     compounds=model.S(:,i);
0435     reactants=find(compounds&lt;0);
0436     products=find(compounds&gt;0);
0437     
0438     <span class="keyword">if</span> any(reactants)
0439         fprintf(fid,<span class="string">'&lt;listOfReactants&gt;'</span>);
0440         <span class="keyword">for</span> j=1:length(reactants)
0441             tempmetname=model.mets{reactants(j)};
0442             fprintf(fid,[<span class="string">'&lt;speciesReference species=&quot;M_'</span> tempmetname <span class="string">'&quot; stoichiometry=&quot;'</span> num2str(-1*compounds(reactants(j))) <span class="string">'&quot;/&gt;'</span>]);
0443         <span class="keyword">end</span>  
0444 
0445         fprintf(fid,<span class="string">'&lt;/listOfReactants&gt;'</span>);
0446     <span class="keyword">end</span>
0447     <span class="keyword">if</span> any(products)
0448         fprintf(fid,<span class="string">'&lt;listOfProducts&gt;'</span>);
0449         <span class="keyword">for</span> j=1:length(products)
0450            tempmetname=model.mets{products(j)};
0451            fprintf(fid,[<span class="string">'&lt;speciesReference species=&quot;M_'</span> tempmetname <span class="string">'&quot; stoichiometry=&quot;'</span> num2str(compounds(products(j))) <span class="string">'&quot;&gt;&lt;/speciesReference&gt;'</span>]);
0452         <span class="keyword">end</span>  
0453         fprintf(fid,<span class="string">'&lt;/listOfProducts&gt;'</span>);
0454     <span class="keyword">end</span>
0455     <span class="keyword">if</span> toCOBRA==false
0456         <span class="keyword">if</span> isfield(model,<span class="string">'genes'</span>) &amp;&amp; isfield(model,<span class="string">'grRules'</span>)
0457             <span class="keyword">if</span> ~isempty(model.grRules{i})
0458                 genes=regexp(model.grRules(i),<span class="string">' or '</span>,<span class="string">'split'</span>);
0459                 genes=genes{1}(:);
0460                 <span class="comment">%Check which of them are complexes</span>
0461                 complexes=cellfun(@any,strfind(genes,<span class="string">':'</span>));
0462                 [I normalGenes]=ismember(genes(~complexes),model.genes);
0463                 normalGenes(~I)=[];
0464                 [I complexGenes]=ismember(genes(complexes),geneComplexes);
0465                 complexGenes(~I)=[];
0466                 toPrint=<span class="string">''</span>;
0467                 <span class="keyword">for</span> j=1:numel(normalGenes)
0468                     toPrint=[toPrint <span class="string">'&lt;modifierSpeciesReference species=&quot;E_'</span> num2str(normalGenes(j)) <span class="string">'&quot; /&gt;'</span>];
0469                 <span class="keyword">end</span>
0470                 <span class="keyword">for</span> j=1:numel(complexGenes)
0471                     toPrint=[toPrint <span class="string">'&lt;modifierSpeciesReference species=&quot;Cx_'</span> num2str(complexGenes(j)) <span class="string">'&quot; /&gt;'</span>];
0472                 <span class="keyword">end</span>
0473                 fprintf(fid,[<span class="string">'&lt;listOfModifiers&gt;'</span> toPrint <span class="string">'&lt;/listOfModifiers&gt;'</span>]);
0474             <span class="keyword">end</span>
0475         <span class="keyword">end</span>
0476     <span class="keyword">end</span>
0477 
0478     <span class="comment">%Print constraints, reversibility, and objective. It's assumed that all</span>
0479     <span class="comment">%information is present in the model structure. This should be ok, since</span>
0480     <span class="comment">%it should have been set to standard values when imported</span>
0481     
0482     <span class="comment">%Note that the order of parameters is hard-coded. It's the same thing</span>
0483     <span class="comment">%in importModel</span>
0484     <span class="keyword">if</span> toCOBRA==false
0485         fprintf(fid,<span class="string">'&lt;kineticLaw&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;ci&gt;FLUX_VALUE&lt;/ci&gt;&lt;/math&gt;&lt;listOfParameters&gt;'</span>);
0486         fprintf(fid,[<span class="string">'&lt;parameter id=&quot;LB_R_'</span> model.rxns{i} <span class="string">'&quot; name=&quot;LOWER_BOUND&quot; value=&quot;'</span> sprintf(<span class="string">'%15.8f'</span>,model.lb(i)) <span class="string">'&quot; units=&quot;mmol_per_gDW_per_hr&quot;/&gt;&lt;parameter id=&quot;UB_R_'</span> model.rxns{i} <span class="string">'&quot; name=&quot;UPPER_BOUND&quot; value=&quot;'</span> sprintf(<span class="string">'%15.8f'</span>,model.ub(i)) <span class="string">'&quot; units=&quot;mmol_per_gDW_per_hr&quot;/&gt;&lt;parameter id=&quot;OBJ_R_'</span> model.rxns{i} <span class="string">'&quot; name=&quot;OBJECTIVE_COEFFICIENT&quot; value=&quot;'</span> sprintf(<span class="string">'%15.8f'</span>,model.c(i)) <span class="string">'&quot; units=&quot;dimensionless&quot;/&gt;&lt;parameter id=&quot;FLUX_VALUE&quot; value=&quot;0.00000000&quot; units=&quot;mmol_per_gDW_per_hr&quot;/&gt;'</span>]);
0487     <span class="keyword">else</span>
0488         fprintf(fid,<span class="string">'&lt;kineticLaw&gt;&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;apply&gt;&lt;ci&gt; LOWER_BOUND &lt;/ci&gt;&lt;ci&gt; UPPER_BOUND &lt;/ci&gt;&lt;ci&gt; OBJECTIVE_COEFFICIENT &lt;/ci&gt;&lt;/apply&gt;&lt;/math&gt;&lt;listOfParameters&gt;'</span>);
0489         fprintf(fid,[<span class="string">'&lt;parameter id=&quot;LOWER_BOUND&quot; value=&quot;'</span> sprintf(<span class="string">'%15.8f'</span>,model.lb(i)) <span class="string">'&quot;/&gt;&lt;parameter id=&quot;UPPER_BOUND&quot; value=&quot;'</span> sprintf(<span class="string">'%15.8f'</span>,model.ub(i)) <span class="string">'&quot;/&gt;&lt;parameter id=&quot;OBJECTIVE_COEFFICIENT&quot; value=&quot;'</span> sprintf(<span class="string">'%15.8f'</span>,model.c(i)) <span class="string">'&quot;/&gt;'</span>]);    
0490     <span class="keyword">end</span>
0491     fprintf(fid,<span class="string">'&lt;/listOfParameters&gt;&lt;/kineticLaw&gt;'</span>);
0492     fprintf(fid,<span class="string">'&lt;/reaction&gt;\n'</span>);
0493 <span class="keyword">end</span>
0494 
0495 <span class="comment">%Write outro</span>
0496 outro=<span class="string">'&lt;/listOfReactions&gt;&lt;/model&gt;&lt;/sbml&gt;'</span>;
0497 fprintf(fid,outro);
0498 
0499 fclose(fid);
0500 
0501 <span class="comment">%Replace the target file with the temporary file</span>
0502 delete(fileName);
0503 movefile(tempF,fileName);
0504 <span class="keyword">end</span>
0505 
0506 <a name="_sub1" href="#_subfunctions" class="code">function miriamString=getMiriam(miriamStruct)</a>
0507 <span class="comment">%Returns a string with list elements for a miriam structure ('&lt;rdf:li</span>
0508 <span class="comment">%rdf:resource=&quot;urn:miriam:obo.go:GO:0005739&quot;/&gt;' for example). This is just</span>
0509 <span class="comment">%to speed ut things since this is done many times during the exporting</span>
0510 
0511 miriamString=<span class="string">''</span>;
0512 <span class="keyword">if</span> isfield(miriamStruct,<span class="string">'name'</span>)
0513     <span class="keyword">for</span> i=1:numel(miriamStruct.name)
0514         miriamString=[miriamString <span class="string">'&lt;rdf:li rdf:resource=&quot;urn:miriam:'</span> miriamStruct.name{i} <span class="string">':'</span> miriamStruct.value{i} <span class="string">'&quot;/&gt;'</span>];
0515     <span class="keyword">end</span>
0516 <span class="keyword">end</span>
0517 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Mon 06-Jan-2014 14:58:12 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>