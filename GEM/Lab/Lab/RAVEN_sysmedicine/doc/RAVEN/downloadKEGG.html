<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of downloadKEGG</title>
  <meta name="keywords" content="downloadKEGG">
  <meta name="description" content="downloadKEGG">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">RAVEN</a> &gt; downloadKEGG.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for RAVEN&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>downloadKEGG
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>downloadKEGG</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function exitFlag=downloadKEGG(keggPath) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> downloadKEGG
   Retrieves files used by getKEGGModelForOrganism from the KEGG FTP

   keggPath    the directory to store the files in

   exitFlag    1 if everything worked, -1 if something went wrong
               
   Usage: exitFlag=downloadKEGG(keggPath)

   Rasmus Agren, 2012-12-16</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="getGenesFromKEGG.html" class="code" title="function model=getGenesFromKEGG(keggPath,koList)">getGenesFromKEGG</a>	getGenesFromKEGG</li><li><a href="getKEGGModelForOrganism.html" class="code" title="function model=getKEGGModelForOrganism(organismID,fastaFile,dataDir,outDir,keepUndefinedStoich,keepIncomplete,keepGeneral,cutOff,minScoreRatioG,minScoreRatioKO,maxPhylDist,nSequences)">getKEGGModelForOrganism</a>	getKEGGModelForOrganism</li><li><a href="getMetsFromKEGG.html" class="code" title="function model=getMetsFromKEGG(keggPath)">getMetsFromKEGG</a>	getMetsFromKEGG</li><li><a href="getPhylDist.html" class="code" title="function phylDistStruct=getPhylDist(keggPath,onlyInKingdom)">getPhylDist</a>	getPhylDist</li><li><a href="getRxnsFromKEGG.html" class="code" title="function model=getRxnsFromKEGG(keggPath,keepUndefinedStoich,keepIncomplete, keepGeneral)">getRxnsFromKEGG</a>	getRxnsFromKEGG</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function exitFlag=downloadKEGG(keggPath)</a>
0002 <span class="comment">% downloadKEGG</span>
0003 <span class="comment">%   Retrieves files used by getKEGGModelForOrganism from the KEGG FTP</span>
0004 <span class="comment">%</span>
0005 <span class="comment">%   keggPath    the directory to store the files in</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%   exitFlag    1 if everything worked, -1 if something went wrong</span>
0008 <span class="comment">%</span>
0009 <span class="comment">%   Usage: exitFlag=downloadKEGG(keggPath)</span>
0010 <span class="comment">%</span>
0011 <span class="comment">%   Rasmus Agren, 2012-12-16</span>
0012 <span class="comment">%</span>
0013 
0014 exitFlag=-1;
0015 <span class="comment">%Check if all necessary files exist in the KEGG path. Otherwise download</span>
0016 <span class="comment">%them from KEGG</span>
0017 necessaryFiles={<span class="string">'compound'</span>;<span class="string">'compound.inchi'</span>;<span class="string">'genes.pep'</span>;<span class="string">'ko'</span>;<span class="string">'reaction'</span>;<span class="string">'reaction.lst'</span>;<span class="string">'taxonomy'</span>;<span class="string">'reaction_mapformula.lst'</span>};
0018 filePathways={<span class="string">'/pub/kegg/ligand/compound/'</span>;<span class="string">'/pub/kegg/ligand/compound/'</span>;<span class="string">'/pub/kegg/genes/fasta/'</span>;<span class="string">'/pub/kegg/genes/'</span>;<span class="string">'/pub/kegg/ligand/reaction/'</span>;<span class="string">'/pub/kegg/ligand/reaction/'</span>;<span class="string">'/pub/kegg/genes/'</span>;<span class="string">'pub/kegg/ligand/reaction/'</span>};
0019 fileExists=false(numel(necessaryFiles),1);
0020 <span class="keyword">for</span> i=1:numel(necessaryFiles)
0021     <span class="keyword">if</span> exist(fullfile(keggPath,necessaryFiles{i}),<span class="string">'file'</span>)
0022         fileExists(i)=true;
0023     <span class="keyword">end</span>
0024 <span class="keyword">end</span>
0025 
0026 <span class="comment">%Download missing files</span>
0027 <span class="keyword">if</span> any(~fileExists)
0028     retrieveFiles=input(<span class="string">'One or more files are missing from the local database. Do you want to connect to KEGG and retrieve them? (Y/N)'</span>,<span class="string">'s'</span>);
0029     <span class="keyword">if</span> strmatch(lower(retrieveFiles),<span class="string">'y'</span>)
0030         fprintf(<span class="string">'\nWARNING: This might take a very long time. The database is about 2 GB.\n'</span>);
0031         getFiles=find(~fileExists);
0032         fprintf(<span class="string">'Attempting to connect to the KEGG database and retrieve the files. The FTP client in Matlab has some known issues. If you do not see that it is sucessfully downloading the files you could get them manually from KEGG. Files to get and place in keggPath:\n'</span>);
0033         <span class="keyword">for</span> i=1:numel(getFiles)
0034             fprintf([<span class="string">'ftp.genome.jp'</span> filePathways{getFiles(i)} necessaryFiles{getFiles(i)} <span class="string">'\n'</span>]);
0035         <span class="keyword">end</span>
0036         
0037         f = ftp(<span class="string">'ftp.genome.jp'</span>);
0038         pasv(f);
0039         <span class="keyword">for</span> i=numel(getFiles)
0040             cd(f,filePathways{getFiles(i)});
0041             fprintf([<span class="string">'Retrieving '</span> filePathways{getFiles(i)} necessaryFiles{getFiles(i)} <span class="string">'\n'</span>]);
0042             mget(f,necessaryFiles{getFiles(i)},keggPath);
0043         <span class="keyword">end</span>
0044         close(ftp);
0045         exitFlag=1;
0046     <span class="keyword">end</span>
0047 <span class="keyword">end</span>
0048 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Mon 06-Jan-2014 14:58:12 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>